{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/schemas/adp-v0.1.schema.json",
  "title": "Agent Definition Protocol v0.1",
  "type": "object",
  "required": ["adp_version", "id", "name", "description", "owner", "tags", "runtime", "skills", "evaluation", "deployment"],
  "properties": {
    "adp_version": {"type": "string", "const": "0.1"},
    "id": {"type": "string", "minLength": 1},
    "name": {"type": "string"},
    "description": {"type": "string"},
    "owner": {"type": "string"},
    "tags": {
      "type": "array",
      "items": {"type": "string"}
    },
    "runtime": {
      "type": "object",
      "required": ["framework", "entrypoint", "language", "models"],
      "properties": {
        "framework": {"type": "string"},
        "entrypoint": {"type": "string"},
        "language": {"type": "string"},
        "image": {
          "type": "object",
          "properties": {
            "registry": {"type": "string"},
            "repository": {"type": "string"},
            "tag": {"type": "string"},
            "digest": {"type": "string"},
            "annotations": {"type": "object", "additionalProperties": {"type": "string"}}
          },
          "additionalProperties": false
        },
        "models": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "required": ["provider", "name"],
            "properties": {
              "provider": {"type": "string"},
              "name": {"type": "string"},
              "purpose": {"type": "string"},
              "endpoint": {"type": "string"}
            },
            "additionalProperties": false
          }
        }
      },
      "additionalProperties": false
    },
    "skills": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["id", "name", "description", "input_modes", "output_modes"],
        "properties": {
          "id": {"type": "string"},
          "name": {"type": "string"},
          "description": {"type": "string"},
          "tags": {"type": "array", "items": {"type": "string"}},
          "examples": {"type": "array", "items": {"type": "string"}},
          "input_modes": {"type": "array", "items": {"type": "string"}},
          "output_modes": {"type": "array", "items": {"type": "string"}},
          "handler": {"type": "string"}
        },
        "additionalProperties": false
      }
    },
    "interop": {
      "type": "object",
      "properties": {
        "a2a": {
          "type": "object",
          "properties": {
            "inline": {"type": "object"},
            "ref": {"type": "string"}
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": true
    },
    "tools": {
      "type": "object",
      "properties": {
        "mcp_servers": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "description", "transport", "endpoint"],
            "properties": {
              "id": {"type": "string"},
              "description": {"type": "string"},
              "transport": {"type": "string"},
              "endpoint": {"type": "string"}
            },
            "additionalProperties": false
          }
        },
        "http_apis": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "description", "base_url"],
            "properties": {
              "id": {"type": "string"},
              "description": {"type": "string"},
              "base_url": {"type": "string", "format": "uri"},
              "auth": {"type": "string"}
            },
            "additionalProperties": false
          }
        },
        "sql_functions": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "description", "connection"],
            "properties": {
              "id": {"type": "string"},
              "description": {"type": "string"},
              "connection": {"type": "string"},
              "schema": {"type": "string"}
            },
            "additionalProperties": false
          }
        }
      },
      "additionalProperties": false
    },
    "memory": {
      "type": "object",
      "properties": {
        "provider": {"type": "string"},
        "endpoint": {"type": "string"},
        "index": {"type": "string"},
        "namespace": {"type": "string"}
      },
      "additionalProperties": false
    },
    "evaluation": {
      "type": "object",
      "required": ["suites", "promotion_policy"],
      "properties": {
        "suites": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "required": ["id", "runner", "config_path"],
            "properties": {
              "id": {"type": "string"},
              "runner": {"type": "string"},
              "config_path": {"type": "string"},
              "metrics": {"type": "array", "items": {"type": "string"}},
              "thresholds": {"type": "object", "additionalProperties": {"type": "number"}}
            },
            "additionalProperties": false
          }
        },
        "kpis": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "name", "description", "url"],
            "properties": {
              "id": {"type": "string"},
              "name": {"type": "string"},
              "description": {"type": "string"},
              "url": {"type": "string", "format": "uri"},
              "target": {"type": ["string", "number"]},
              "unit": {"type": "string"}
            },
            "additionalProperties": false
          }
        },
        "promotion_policy": {
          "type": "object",
          "properties": {
            "require_passing_suites": {
              "type": "array",
              "items": {"type": "string"}
            }
          },
          "required": ["require_passing_suites"],
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "governance": {
      "type": "object",
      "properties": {
        "identity": {"type": "string"},
        "allowed_data_scopes": {"type": "array", "items": {"type": "string"}},
        "forbidden_data_scopes": {"type": "array", "items": {"type": "string"}},
        "telemetry_endpoint": {"type": "string"},
        "guardrail_policy_set": {"type": "string"}
      },
      "additionalProperties": false
    },
    "deployment": {
      "type": "object",
      "required": ["environments"],
      "properties": {
        "environments": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "required": ["name", "endpoint"],
            "properties": {
              "name": {"type": "string"},
              "endpoint": {"type": "string"}
            },
            "additionalProperties": false
          }
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
